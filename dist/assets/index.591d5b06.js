var Se=Object.defineProperty,Te=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var re=(t,a,n)=>a in t?Se(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,B=(t,a)=>{for(var n in a||(a={}))Ae.call(a,n)&&re(t,n,a[n]);if(oe)for(var n of oe(a))Ie.call(a,n)&&re(t,n,a[n]);return t},L=(t,a)=>Te(t,ke(a));import{r as m,R as e,a as Fe,L as V,u as U,A as me,F as P,I as $,O as D,b as te,c as ue,d as q,V as Oe,e as Me,f as pe,M as ee,H as qe,B as Pe,g as $e,C as De,P as Ue,T as Y,S as Re,h as Be,i as I,j as Le,k as je,l as ze,m as J,t as O,n as Qe,o as ae,p as Ee,q as he,s as ge,E as fe,D as ve,v as He,w as We,x as Je,y as _e,z as Ve,G as Ke,J as le,K as W,N as Xe,Q as Ge,U as Ye,W as A,X as _,Y as Ze,Z as et,_ as tt}from"./vendor.241b3321.js";const at=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}};at();const be=m.exports.createContext({}),nt=({children:t})=>{const[a,n]=m.exports.useState(),[s,o]=m.exports.useState(""),l=p=>{n(p)},r=p=>{o(p)},c=()=>{o(""),n(void 0)};return e.createElement(be.Provider,{value:{user:a,authToken:s,storeUser:l,storeToken:r,clean:c}},t)},R=()=>e.useContext(be);const st={Accept:"application/json, text/plain, */*","X-CSRF-TOKEN":"",Authorization:"Bearer "},T=Fe.create({baseURL:"https://virtual-assistent-backend.herokuapp.com/",headers:st}),F={getInitialTopicsTree:async()=>T.get("/api/v1/topics"),getTopicsTreeById:async t=>T.get(`/api/v1/topics/${t}`),getTopicsTreeByNlp:async t=>T.post("/api/v1/nlp",{text:t}),login:async t=>T.post("/api/v2/auth/login",t),requestPassword:async t=>T.get(`/api/v2/auth/recoverAccess/${t}`),getTopicsTree:async t=>{var n;let a=t;return a||(a=((n=M())==null?void 0:n.token)||""),T.get("/api/v3/topics",{headers:{Accept:"application/json, text/plain, */*","X-CSRF-TOKEN":"",Authorization:`Bearer ${a}`}})},createQuestion:async(t,a,n,s)=>{var r;let o=t;o||(o=((r=M())==null?void 0:r.token)||"");const l={topic_id:a,description:n,answer:s};return T.post("/api/v3/questions",l,{headers:{Accept:"application/json, text/plain, */*","X-CSRF-TOKEN":"",Authorization:`Bearer ${o}`}})},getQuestions:async t=>{var n;let a=t;return a||(a=((n=M())==null?void 0:n.token)||""),T.get("/api/v3/questions",{headers:{Accept:"application/json, text/plain, */*","X-CSRF-TOKEN":"",Authorization:`Bearer ${a}`}})},editQuestion:async(t,a,n,s,o)=>{var c;let l=a;l||(l=((c=M())==null?void 0:c.token)||"");const r={id:t,topic_id:n,description:s,answer:o};return T.patch(`/api/v3/questions/${t}`,r,{headers:{Accept:"application/json, text/plain, */*","X-CSRF-TOKEN":"",Authorization:`Bearer ${l}`}})},deleteQuestion:async(t,a)=>{var s;let n=a;return n||(n=((s=M())==null?void 0:s.token)||""),T.delete(`/api/v3/questions/${t}`,{headers:{Accept:"application/json, text/plain, */*","X-CSRF-TOKEN":"",Authorization:`Bearer ${n}`}})},getUsers:async()=>{var a;const t={headers:{Authorization:"Bearer "+((a=M())==null?void 0:a.token)}};return T.get("/api/v3/users",t)},createUser:async(t,a,n)=>{var o;const s={headers:{Authorization:"Bearer "+((o=M())==null?void 0:o.token)}};return T.post("/api/v3/users",{email:t,name:a,password:n},s)},editUser:async(t,a)=>{var s;const n={headers:{Authorization:"Bearer "+((s=M())==null?void 0:s.token)}};return T.patch(`/api/v3/users/${t}`,a,n)},deleteUser:async t=>{var n;const a={headers:{Authorization:"Bearer "+((n=M())==null?void 0:n.token)}};return T.delete(`/api/v3/users/${t}`,a)},createTopic:async(t,a,n)=>{var r;let s=t;s||(s=((r=M())==null?void 0:r.token)||"");const o={name:a},l=n?`/${n}`:"";return T.post(`/api/v3/topics${l}`,o,{headers:{Accept:"application/json, text/plain, */*",Authorization:`Bearer ${s}`}})},deleteTopic:async(t,a)=>{var s;let n=a;return n||(n=((s=M())==null?void 0:s.token)||""),T.delete(`/api/v3/topics/${t}`,{headers:{Accept:"application/json, text/plain, */*","X-CSRF-TOKEN":"",Authorization:`Bearer ${n}`}})}},ot=t=>{window.sessionStorage.setItem("AUTH",JSON.stringify(t))},M=()=>{const t=window.sessionStorage.getItem("AUTH");return t?JSON.parse(t):null},rt=()=>{window.sessionStorage.removeItem("AUTH")};var lt="/assets/logo-ic-ufba.d4b7fcf3.png",ct="/assets/logo-icia-vertical.dc3a2a24.svg";function ne({children:t}){return e.createElement("div",{className:`auth-container d-flex flex-column overflow-auto justify-content-start\r
                 justify-content-sm-center align-items-center p-3 p-md-4 min-vh-100 w-100`},e.createElement("div",{className:"shadow-sm rounded bg-white w-100 p-3"},e.createElement("div",{className:"px-3 pt-3 pb-4"},e.createElement(V,{to:"/",className:"logo d-flex mx-auto mb-4 align-items-end justify-content-center"},e.createElement("div",{className:"d-flex",style:{width:"60%"}},e.createElement("img",{src:ct,alt:"Logomarca ICIA",className:"w-100"})),e.createElement("div",{className:"d-flex pl-3",style:{width:"38%"}},e.createElement("img",{src:lt,alt:"Logo Computa\xE7\xE3o Ufba",className:"w-100"}))),t)),e.createElement("div",{className:"w-100 mt-2 text-center text-white"},"\xA9 Todos os direitos reservados."))}function it(){const t=U(),[a,n]=e.useState(!1),[s,o]=e.useState(!1),[l,r]=e.useState(!1),[c,p]=e.useState({email:"",password:"",showPassword:!1}),{storeUser:f,storeToken:E}=R(),i=C=>v=>{p(L(B({},c),{[C]:v.target.value})),o(!1)},d=()=>{p(L(B({},c),{showPassword:!c.showPassword}))},u=C=>{C.preventDefault()},S=C=>{C.preventDefault(),!!c.email||!!c.email?(r(!0),F.login(c).then(v=>v.data).then(v=>{var k,y;if(v.status==="Success"){const N=(k=v.data)==null?void 0:k.user;f(N),E((y=v.data)==null?void 0:y.token),ot(v.data),t("/dashboard")}r(!1)}).catch(v=>{r(!1),n(!0),o(!0),p(L(B({},c),{password:""}))})):o(!0)};return e.createElement(ne,null,a?e.createElement(me,{severity:"error"},"Seu e-mail ou senha n\xE3o correspondem aos nossos registros."):null,e.createElement("form",{onSubmit:S,action:"#"},e.createElement(P,{variant:"outlined",error:s,fullWidth:!0,margin:"normal"},e.createElement($,{htmlFor:"email"},"E-mail"),e.createElement(D,{id:"email",type:"email",value:c.email,onChange:i("email"),label:"E-mail"}),s?e.createElement(te,{id:"e-mail-error-text"},c.email?"E-mail ou senha incorreto.":"Campo obrigat\xF3rio."):null),e.createElement(P,{variant:"outlined",error:s,fullWidth:!0,margin:"normal"},e.createElement($,{htmlFor:"password"},"Senha"),e.createElement(D,{id:"password",type:c.showPassword?"text":"password",value:c.password,onChange:i("password"),endAdornment:e.createElement(ue,{position:"end"},e.createElement(q,{"aria-label":"toggle password visibility",onClick:d,onMouseDown:u,edge:"end"},c.showPassword?e.createElement(Oe,null):e.createElement(Me,null))),label:"Senha"}),s?e.createElement(te,{id:"password-error-text"},c.password?"E-mail ou senha incorreto.":"Campo obrigat\xF3rio."):null),e.createElement("div",{className:"d-flex mb-3 justify-content-end"},e.createElement(V,{to:"/request-password",id:"request-password__button"},"Esqueceu sua senha?")),e.createElement(pe,{id:"submitt-button",type:"submit",loading:l,variant:"contained",className:"mb-3",disableElevation:!0,fullWidth:!0},"Entrar")))}function dt(){const[t,a]=e.useState(!1),[n,s]=e.useState(!1),[o,l]=e.useState(!1),[r,c]=e.useState({email:""}),p=E=>i=>{c(L(B({},r),{[E]:i.target.value})),o&&l(!1),n&&s(!1)},f=async E=>{E.preventDefault();const i=r.email;if(i){a(!0);try{const d=await F.requestPassword(i);console.log(d)}catch(d){console.log(d)}a(!1),s(!0)}else l(!0)};return e.createElement(ne,null,e.createElement("form",{onSubmit:f,action:"#"},n?e.createElement(me,{severity:"success"},"Se o e-mail ",e.createElement("b",null,r.email)," estiver cadastrado, voc\xEA receber\xE1 instru\xE7\xF5es para recuperar sua senha."):null,e.createElement(P,{variant:"outlined",error:o,fullWidth:!0,margin:"normal",className:"mb-4"},e.createElement($,{htmlFor:"email"},"E-mail"),e.createElement(D,{id:"email",type:"email",value:r.email,onChange:p("email"),label:"E-mail"}),o?e.createElement(te,{id:"e-mail-error-text"},"Campo obrigat\xF3rio."):null),e.createElement(pe,{id:"submitt-button",type:"submit",loading:t,variant:"contained",className:"mb-3",disableElevation:!0,fullWidth:!0},"Enviar")),e.createElement(V,{to:"/login"},"Fazer login")," em vez disso.")}function mt(){return e.createElement(ne,null,e.createElement("p",null,"request-password works!"))}function ut({handleSidebarOptionClick:t}){const[a,n]=m.exports.useState(!1),[s,o]=m.exports.useState(null),l=f=>{console.log("Aqui"),o(f.currentTarget)},r=()=>{o(null)},c=Boolean(s),p=c?"learn-more-popover":void 0;return e.createElement("aside",{className:"d-none d-sm-flex flex-column align-items-center border-right border-info h-100"},e.createElement(ee,{title:"Reiniciar",placement:"right"},e.createElement(q,{"aria-label":"home",onClick:()=>t("home")},e.createElement(qe,null))),e.createElement(ee,{title:a?"Modo claro":"Modo escuro",placement:"right"},e.createElement(q,{"aria-label":"theme-mode",onClick:()=>{n(!a),t("mode")}},a?e.createElement(Pe,null):e.createElement($e,null))),e.createElement(ee,{title:"Saia mais",placement:"right"},e.createElement(q,{onClick:l,"aria-describedby":p},e.createElement(De,null))),e.createElement(Ue,{id:p,open:c,anchorEl:s,onClose:r,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},e.createElement(Y,{sx:{p:2}},'O ICIA \xE9 um sistema de "BOT" com o objetivo de responder as d\xFAvidas relacionadas ao Instituto de Computa\xE7\xE3o (IC) da UFBA, especialmente dos cursos de gradua\xE7\xE3o e p\xF3s-gradua\xE7\xE3o do PGCOMP.',e.createElement("br",null),e.createElement("br",null),"O aplicativo foi desenvolvido por discentes de cursos de gradua\xE7\xE3o e p\xF3s-gradua\xE7\xE3o vinculados ao PGCOMP, sob a orienta\xE7\xE3o do Prof. Dr. Frederico Dur\xE3o, referente a disciplina T\xF3picos em Sistemas de Informa\xE7\xE3o e Web I no semestre letivo de 2022.1.")))}function pt({generateMessegesOnFormSubmit:t}){const[a,n]=e.useState(""),s=()=>l=>{l.preventDefault(),t(a),n("")},o=()=>l=>{n(l.target.value)};return e.createElement("div",{className:"chat-input-container rounded-pill border border-info position-relative overflow-hidden w-100"},e.createElement("form",{onSubmit:s()},e.createElement("input",{type:"text",className:"py-2 pl-4 pr-5 w-100 border-0",onChange:o(),placeholder:"Digite alguma pergunta",value:a}),e.createElement("div",{className:"position-absolute"},e.createElement(q,{type:"submit","aria-label":"cached",disabled:!a.length},e.createElement(Re,null)))))}var xe="/assets/icon-icia.06ab72ef.svg";function ce({items:t,handleItemSelection:a}){const[n,s]=m.exports.useState(),o=r=>{s(r.id),a(r)},l=r=>r.description!==void 0;return e.createElement(e.Fragment,null,t!=null&&t.length?e.createElement("div",{className:"chat-items"},t.map(r=>e.createElement("button",{type:"button",key:r.id,onClick:()=>o(r),title:l(r)?r.description:r.name,className:`chat-item-option d-block rounded-pill bg-info text-dark py-2 px-3 mt-3 border-0${n===r.id?" selected":""}`},e.createElement("span",null,l(r)?r.description:r.name)))):null)}function ie({children:t,questions:a,side:n,text:s,topics:o,askUseful:l,handleUsefulOptionClick:r,generateMessegesForTopicSelection:c,generateMessegesForQuestionSelection:p}){const f=d=>{typeof c=="function"&&E(d)&&c(d),typeof p=="function"&&i(d)&&p(d)},E=d=>d.name!==void 0,i=d=>d.description!==void 0;return e.createElement("div",{className:`chat-message d-flex ${n} w-100`},e.createElement("div",{className:"chat-user rounded-circle align-self-end d-flex align-items-center justify-content-center"},n==="left"?e.createElement("img",{src:xe,className:"h-auto",alt:"assistente chatbot"}):e.createElement(Be,null,"person")),e.createElement("div",{className:"chat-ballon py-3 px-4"},s!=null&&s.length?e.createElement("h3",{className:"font-weight-normal mb-0"},s.trim().split(" ").map((d,u)=>d.includes("://")?e.createElement(e.Fragment,null,"\xA0",e.createElement("a",{target:"_blank",className:"text-white",href:d,rel:"noreferrer",key:u},d)):e.createElement("span",{key:u}," ",d))):null,t,e.createElement(ce,{items:o,handleItemSelection:f}),a!=null&&a.length?e.createElement("div",{className:"d-block w-100"},e.createElement(ce,{items:a,handleItemSelection:f})):null,l&&r?e.createElement("div",{className:"d-block w-100"},e.createElement("h4",{className:"font-weight-normal mb-1 pt-2"},"Esta resposta foi \xFAtil?"),e.createElement("div",{className:"d-flex"},e.createElement("button",{type:"button",onClick:()=>r(!0),title:"Sim",className:"chat-item-option d-block rounded bg-info text-dark py-0 px-2 border-0"},e.createElement("span",null,"Sim")),e.createElement("button",{type:"button",onClick:()=>r(!1),title:"N\xE3o",className:"chat-item-option d-block rounded bg-info text-dark py-0 px-2 ml-2 border-0"},e.createElement("span",null,"N\xE3o")))):null,e.createElement("div",null)))}function Et(){return e.createElement("div",{className:"d-flex align-items-center typing"},e.createElement("div",{className:"dot"}),e.createElement("div",{className:"dot"}),e.createElement("div",{className:"dot"}))}var ht="/assets/icon-ic-ufba.2625d738.png",gt="/assets/logo-icia-horizontal-text-white.dc2df070.svg";function ye({children:t}){return e.createElement("header",{className:"d-flex align-items-center justify-content-start w-100 app-header px-3 position-relative shadow-sm"},e.createElement("img",{"data-testid":"logo1",src:gt,className:"app-logo d-none d-sm-block",alt:"logo"}),e.createElement("img",{"data-testid":"logo2",src:xe,className:"app-logo d-block d-sm-none",alt:"logo"}),e.createElement("img",{"data-testid":"logo3",src:ht,className:"app-logo ml-4",alt:"logo"}),e.createElement("h1",{className:"app-computacao mb-0 ml-2 font-weight-normal text-white d-none d-sm-block"},"computa\xE7\xE3o",e.createElement("br",null),e.createElement("span",null,"UFBA")),e.createElement("div",{className:"flex-fill"}),t)}function ft(){const t=m.exports.useRef(null),[a,n]=m.exports.useState(0),[s,o]=m.exports.useState([]),[l,r]=m.exports.useState(!0),[c,p]=m.exports.useState(!1);let f=U();const E=["Agora escolha uma op\xE7\xE3o :)","Escolha mais uma op\xE7\xE3o abaixo.","Quase l\xE1, selecione uma op\xE7\xE3o.","Veja algumas op\xE7\xF5es que encontrei :)"];m.exports.useEffect(()=>{F.getInitialTopicsTree().then(h=>{const b=y(h.data);r(!1),a>0&&o([]),o([{text:a===0?"Ol\xE1, eu sou a Icia. Como posso te ajudar hoje?":"Ok... vamos tentar de novo. Como posso te ajudar hoje?",side:"left",topics:b}])}),a===0&&i()},[a]);const i=()=>{t&&t.current.addEventListener("DOMNodeInserted",h=>{const b=h.currentTarget;b.scroll({top:b.scrollHeight,behavior:"smooth"})})},d=h=>{h?o([...s,{text:"Sim",side:"right"},{text:"Que bom! \u{1F60A}\u{1F60A}",side:"left"}]):(o([...s,{text:"N\xE3o",side:"right"}]),u("home"))},u=h=>{switch(h){case"home":n(1+a);break;case"mode":p(!c);break;default:alert("N\xE3o implementado!")}},S=async h=>{const b=[...s,{text:h.name,side:"right"}];o(b),r(!0);const j=(await F.getTopicsTreeById(h.id)).data.find(Boolean),H=y(j.children),X=j.questions;b.push({text:E[Math.floor(Math.random()*E.length)],side:"left",topics:H,questions:X}),r(!1),o(b)},C=async h=>{const b=[...s,{text:h.description,side:"right"},{text:h.answer,side:"left",askUseful:!0}];o(b)},v=async h=>{const b=[...s,{text:h,side:"right"}];if(o(b),k(h)){n(a+1);return}r(!0);try{const w=await F.getTopicsTreeByNlp(h);if(!w.data)throw new Error("no content");const j=Q(w.data[0])?w.data:[],H=N(w.data[0])?w.data:[];b.push({text:E[Math.floor(Math.random()*E.length)],side:"left",topics:H,questions:j})}catch{b.push({text:"Ohh, n\xE3o... N\xE3o encontrei uma resposta para a sua pergunta.           Tente pesquisar com outro termo ou utilizar as op\xE7\xF5es do menu :(",side:"left"})}r(!1),o(b)},k=h=>{const b=new RegExp(/^exit|menu|clear|limpar|sair|out$/),w=h.trim().toLowerCase();return b.test(w)},y=h=>h===void 0?[]:h.filter(w=>!!w.name.length).map(w=>({id:w.id,name:w.name})),N=h=>h.name!==void 0,Q=h=>h.description!==void 0;return e.createElement("div",{className:"chatbot d-block w-100"+(c?" dark":"")},e.createElement("div",{className:"d-block min-vh-100 vh-100 w-100 mx-auto"},e.createElement(ye,null,e.createElement(I,{id:"login-button",type:"button",variant:"contained",color:"secondary",disableElevation:!0,onClick:()=>{f("/login")}},"Login")),e.createElement("div",{className:"chat-container d-flex"},e.createElement(ut,{handleSidebarOptionClick:u}),e.createElement("main",{className:"d-flex flex-column flex-fill"},e.createElement("div",{ref:t,className:"chat-content d-flex flex-column flex-fill w-100 mw-100 p-3"},s.map((h,b)=>e.createElement(ie,{key:b,text:h.text,side:h.side,topics:h.topics,questions:h.questions,askUseful:h.askUseful||!1,handleUsefulOptionClick:d,generateMessegesForTopicSelection:S,generateMessegesForQuestionSelection:C})),l?e.createElement(ie,{side:"left"},e.createElement(Et,null)):null),e.createElement("div",{className:"chat-toolbar d-flex align-items-center border-top border-info px-3"},e.createElement(pt,{generateMessegesOnFormSubmit:v}))))))}const we=Le({palette:{primary:{light:"#72C3E6",main:"#72C3E6",dark:"#72C3E6",contrastText:"#FFF"},secondary:{light:"#F9D055",main:"#F9D055",dark:"#F9D055",contrastText:"#FFF"}},typography:{fontFamily:["IBM Plex Sans","-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")}}),vt=[{id:"question-link",icon:t=>e.createElement(je,{htmlColor:t}),name:"Perguntas",path:"/dashboard/questions",isSelected:!1},{id:"users-link",icon:t=>e.createElement(ze,{htmlColor:t}),name:"Usu\xE1rios",path:"/dashboard/users",isSelected:!1}],bt=()=>e.createElement("nav",{id:"container"},vt.map(t=>{const a=window.location.pathname.includes(t.path);return e.createElement(V,{"data-testid":t.id,to:t.path,key:t.id},e.createElement("div",{className:"menu-option"},e.createElement("i",{className:"menu-icon"},t.icon(a?we.palette.secondary.main:"")),e.createElement("span",{className:a?"is-selected":""},t.name)))}));function K({children:t}){const{clean:a,user:n}=R(),s=U(),o=J().state,l=J().pathname,r=o==null?void 0:o.message;return m.exports.useEffect(()=>{r&&(O[r.type](r.text),history.replaceState({message:null},""))},[]),e.createElement("div",{className:"app"},e.createElement(ye,null,e.createElement(I,{id:"profile-edit",startIcon:e.createElement(Qe,null),type:"button",variant:"contained",color:"secondary",disableElevation:!0,onClick:()=>{l!=="/dashboard/users/edit"&&l!=="/dashboard/users/create"&&s("/dashboard/users/edit",{state:n})}},n==null?void 0:n.name),e.createElement(V,{to:"/",target:"_blank"},e.createElement(I,{id:"chat-button",type:"button",variant:"contained",color:"secondary",disableElevation:!0},"Chat")),e.createElement(I,{id:"logout-button",type:"button",variant:"contained",color:"secondary",disableElevation:!0,onClick:()=>{rt(),a(),s("/login",{replace:!0})}},"Sair")),e.createElement("div",{id:"admin-container",className:"d-flex"},e.createElement(bt,null),e.createElement("main",{id:"admin-content"},t)))}const Ce=({description:t,answer:a,isEdit:n,handleSubmit:s,handleQuestionChange:o,handleAnswerChange:l})=>e.createElement("form",{onSubmit:s,className:"formContainer"},e.createElement(P,{className:"mt-4",variant:"outlined",fullWidth:!0,color:"secondary"},e.createElement($,{htmlFor:"input-question"},"Pergunta"),e.createElement(D,{id:"input-question",type:"text",placeholder:"Digite a pergunta",value:t,onChange:r=>o(r.target.value),label:"Pergunta"})),e.createElement("div",{className:" mb-2"},e.createElement(P,{className:"mt-4",variant:"outlined",color:"secondary",fullWidth:!0},e.createElement($,{htmlFor:"input-answer"},"Resposta"),e.createElement(D,{id:"input-answer",type:"text",placeholder:"Digite a resposta",value:a,onChange:r=>l(r.target.value),label:"Resposta"}))),n?e.createElement(I,{variant:"contained",color:"secondary",type:"submit","data-testid":"submit-button"},"EDITAR"):e.createElement(I,{variant:"contained",color:"secondary",type:"submit","data-testid":"submit-button"},"CADASTRAR")),xt=()=>{const t=U(),[a,n]=m.exports.useState(""),[s,o]=m.exports.useState(""),{authToken:l}=R(),{topicId:r,topicName:c}=J().state,p=i=>{o(i)},f=i=>{n(i)},E=i=>{i.preventDefault(),F.createQuestion(l,r,a,s).then(d=>d.data).then(d=>{console.log(d);const u=JSON.parse(window.sessionStorage.getItem("selectedTopic")||"");if(u){const{questions:S}=u,C=[...S,d.data],v=L(B({},u),{questions:C});window.sessionStorage.setItem("selectedTopic",JSON.stringify(v))}t("/dashboard/questions",{state:{message:{type:"success",text:"Pergunta adicionada com sucesso!"}}})}).catch(d=>{})};return e.createElement(K,null,e.createElement("div",{className:"d-flex align-items-center mt-2"},e.createElement(q,{className:"mr-3 ml-3","aria-label":"Voltar",component:"span",onClick:()=>{t(-1)}},e.createElement(ae,null)),e.createElement("span",{className:"title"},"Cadastrar Pergunta em ",c)),e.createElement(Ce,{description:a,answer:s,handleSubmit:E,handleAnswerChange:p,handleQuestionChange:f}))},yt=()=>{const{id:t,topic_id:a,topicName:n,description:s,answer:o}=J().state,l=U(),[r,c]=m.exports.useState(s),[p,f]=m.exports.useState(o),{authToken:E}=R(),[i,d]=m.exports.useState(!1),{pathname:u}=J(),S=u.includes("edit"),C=y=>{f(y)},v=y=>{c(y)},k=y=>{y.preventDefault(),d(!0),F.editQuestion(t,E,a,r,p).then(N=>N.data).then(N=>{d(!1),l("/dashboard/questions",{state:{message:{type:"success",text:"Pergunta editada com sucesso!"}}})}).catch(N=>{O.error("Ocorreu um erro"),d(!1)})};return e.createElement(K,null,i&&e.createElement(Ee,{variant:"indeterminate"}),e.createElement("div",{className:"d-flex align-items-center mt-2"},e.createElement(q,{className:"mr-3 ml-3","aria-label":"Voltar",component:"span",onClick:()=>{l(-1)}},e.createElement(ae,null)),e.createElement("span",{className:"title"},"Editar Pergunta",n)),e.createElement(Ce,{description:r,answer:p,handleSubmit:k,handleAnswerChange:C,handleQuestionChange:v,isEdit:S}))};function wt({isOpen:t,onClose:a,onConfirm:n,parentId:s}){const[o,l]=m.exports.useState(""),[r,c]=m.exports.useState(""),p=s?"subategoria":"categoria",{authToken:f}=R(),E=i=>{if(i.preventDefault(),c(""),o===""){c(`Adicione o nome da ${p}`);return}F.createTopic(f,o,s).then(d=>d.data).then(d=>{n(),console.log(d),l(""),O.success("Categoria adicionada com sucesso.")}).catch(d=>{console.log(d),O.error("Houve um erro ao adicionar a categoria.")})};return e.createElement("div",null,e.createElement(he,{open:t,onClose:a,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description"},e.createElement(ge,{className:"create-modal-box"},e.createElement(Y,{id:"modal-modal-title",variant:"h6",component:"h2"},"Adicionar ",p),e.createElement("form",{onSubmit:E},e.createElement(P,{className:"mt-4",variant:"outlined",fullWidth:!0,color:"secondary"},e.createElement($,{htmlFor:"topic"},"Nome"),e.createElement(D,{id:"topic",type:"text",value:o,color:"secondary",onChange:i=>l(i.target.value),placeholder:`Digite a ${p}`,label:"Nome"}),e.createElement("small",{className:"text-danger"},r),e.createElement("div",{className:"create-modal-footer"},e.createElement(I,{variant:"contained",color:"secondary",type:"submit","data-testid":"confirm-button"},"Adicionar"),e.createElement(I,{variant:"outlined",onClick:()=>{c(""),a()},className:"ml-2"},"Cancelar")))))))}function Z({title:t,text:a,isOpen:n,handleClose:s,handleConfirm:o}){return m.exports.createElement("div",null,m.exports.createElement(he,{open:n,onClose:s,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description"},m.exports.createElement(ge,{className:"modal-box"},m.exports.createElement(Y,{id:"modal-modal-title",variant:"h6",component:"h2"},t),m.exports.createElement(Y,{id:"modal-modal-description",sx:{mt:2}},a),m.exports.createElement("div",{className:"modal-footer"},m.exports.createElement(I,{variant:"contained",color:"warning",onClick:o,"data-testid":"confirm-button"},"Sim"),m.exports.createElement(I,{variant:"outlined",onClick:s,className:"ml-2"},"N\xE3o")))))}function Ct({questions:t,removeQuestion:a}){const n=U(),{authToken:s}=R(),[o,l]=e.useState(!1),[r,c]=e.useState(),p=u=>{const{id:S,topic_id:C,description:v,answer:k,parents:y}=u;let N=C;!N&&y&&(N=y[y.length-1].id),n("edit",{state:{id:S,topic_id:N,description:v,answer:k}})},f=u=>{F.deleteQuestion(u,s).then(S=>{if(S.data.status==="Success"){a&&a(u);const v=JSON.parse(window.sessionStorage.getItem("selectedTopic")||"");if(v){const{questions:k}=v,y=k.filter(Q=>Q.id!==u),N=L(B({},v),{questions:y});window.sessionStorage.setItem("selectedTopic",JSON.stringify(N))}O.success("Pergunta exclu\xEDda com sucesso!")}else O.error("Houve um erro ao excluir a pergunta.");i()})},E=u=>{c(u),l(!0)},i=()=>{c(void 0),l(!1)},d=[{field:"description",headerName:"Pergunta",flex:3},{field:"answer",headerName:"Resposta",flex:3},{field:"parents",valueFormatter:u=>{var S;return(u==null?void 0:u.value)&&((S=u==null?void 0:u.value[0])==null?void 0:S.name)||""},headerName:"Categoria",flex:3,hide:t.every(u=>!u.parents)},{field:"id",headerName:"A\xE7\xF5es",renderCell:u=>e.createElement(e.Fragment,null,e.createElement(Z,{title:"Excluir Pergunta",text:"Tem certeza que deseja excluir essa pergunta?",isOpen:o&&r===u.row.id,handleClose:i,handleConfirm:()=>f(r)}),e.createElement(q,{"aria-label":"Editar","data-testid":"edit-button",component:"span",onClick:()=>p(u.row)},e.createElement(fe,null)),e.createElement(q,{"data-testid":"delete-button","aria-label":"Deletar",component:"span",onClick:()=>{E(u.row.id)}},e.createElement(ve,null)))}];return e.createElement("div",{style:{height:Math.min(t.length*6+30,80)+"vh",width:"100%"}},e.createElement(He,{rows:t||[],columns:d,pageSize:15,disableSelectionOnClick:!0}))}function Nt(){const[t,a]=m.exports.useState([]),[n,s]=m.exports.useState([]),[o,l]=m.exports.useState([]),[r,c]=m.exports.useState([]),[p,f]=m.exports.useState(""),[E,i]=m.exports.useState(0),[d,u]=m.exports.useState(!1),[S,C]=m.exports.useState(!1),[v,k]=m.exports.useState(!1),y=U(),{authToken:N}=R(),{getTopicsTree:Q,getQuestions:h,deleteTopic:b}=F,w=()=>{u(!1)},j=()=>{c(g=>[...g]),C(!1)},H=()=>{s([]),c(o),f(""),i(0),a([]),window.sessionStorage.removeItem("breadcrumb"),window.sessionStorage.removeItem("selectedTopic")},X=g=>{k(!0),b(g,N).then(x=>x==null?void 0:x.data).then(x=>{console.log(x),x.status==="Success"?(O.success("Categoria exclu\xEDda com sucesso!"),se()):(console.log(x),O.error("Aconteceu um erro ao excluir a categoria."))}).catch(x=>{console.log(x),O.error("Aconteceu um erro ao excluir a categoria.")}).finally(()=>{k(!1),w()})},Ne=g=>{a(x=>x.filter(z=>z.id!==g))};m.exports.useEffect(()=>{const g=window.sessionStorage.getItem("breadcrumb"),x=window.sessionStorage.getItem("selectedTopic");if(g&&x){const z=JSON.parse(g),G=JSON.parse(x);s(z),i(G.id),f(G.name),c(G.children),a(G.questions)}else E===0&&(se(),h(N).then(z=>{a(z.data)}))},[E]);const se=e.useCallback(()=>{k(!0),Q(N).then(g=>{r.length===0&&(H(),c(g.data||[]),l(g.data||[]))}).finally(()=>k(!1))},[E,Q,c,l]);return e.createElement(K,null,v&&e.createElement(Ee,{variant:"indeterminate"}),e.createElement("div",{className:"d-flex justify-content-between align-items-center pr-5"},e.createElement("div",{className:"title-container"},e.createElement("h2",{className:"title"},"Perguntas por categoria")),e.createElement(wt,{isOpen:S,onClose:j,parentId:E,onConfirm:()=>{j()}}),p&&e.createElement(e.Fragment,null,e.createElement(Z,{title:"Excluir Pergunta",text:`Tem certeza que deseja excluir a categoria ${p}?`,isOpen:d,handleClose:w,handleConfirm:()=>X(E)}))),e.createElement("div",{className:"questions-container"},e.createElement("div",{className:"breadcrumb-container"},E!==0?e.createElement("span",null,e.createElement("button",{className:"breadcrumb-item",onClick:()=>{H()}},"Categorias iniciais")," > "):e.createElement("span",null),n.map((g,x)=>x!==n.length-1?e.createElement("span",{key:g.id},e.createElement("button",{className:"breadcrumb-item",onClick:()=>{s(z=>z.slice(0,x+1)),c(g.children),f(g.name),i(g.id),a(g.questions),window.sessionStorage.setItem("breadcrumb",JSON.stringify(n.slice(0,x+1))),window.sessionStorage.setItem("selectedTopic",JSON.stringify(g))}},g.name)," > "):e.createElement(e.Fragment,null,g.name))),r.map(g=>g.name===""?null:e.createElement("button",{key:g.id,className:"filter-question-button",onClick:()=>{a(g.questions),s(x=>[...x,g]),c(g.children),f(g.name),i(g.id),window.sessionStorage.setItem("breadcrumb",JSON.stringify([...n,g])),window.sessionStorage.setItem("selectedTopic",JSON.stringify(g))}},g.name)),e.createElement("div",{className:"mt-2 d-flex justify-content-row"},e.createElement(I,{className:"add-category-button mr-2",variant:"contained",onClick:()=>C(!0)},"+ ",p?"Subcategoria":"Categoria"),p&&e.createElement(e.Fragment,null,e.createElement(Z,{title:"Excluir Pergunta",text:`Tem certeza que deseja excluir a categoria ${p}?`,isOpen:d,handleClose:w,handleConfirm:()=>X(E)}),e.createElement(I,{variant:"contained",color:"warning","data-testid":"remove-category-button",onClick:()=>{u(!0)}},"Excluir"))),e.createElement("div",{className:"mt-3"},p&&e.createElement(e.Fragment,null,e.createElement("h3",null,'Perguntas da subcategoria `"`',p,'`"`'),e.createElement("br",null),e.createElement("div",null,e.createElement(I,{variant:"contained","data-testid":"add-question-button",onClick:()=>{y("/dashboard/questions/create",{state:{topicId:E,topicName:p}})}},"ADICIONAR")))),e.createElement("div",{id:"questions-container"},e.createElement(Ct,{questions:t,removeQuestion:Ne}))))}function de(){const{clean:t,user:a}=R(),n=U(),{id:s,name:o,email:l,password:r}=J().state,[c,p]=e.useState({email:l||"",name:o||"",password:""}),f=i=>d=>{p(L(B({},c),{[i]:d.target.value}))},E=i=>{if(i.preventDefault(),s){const d={email:c.email,name:c.name};c.password&&(d.password=c.password),F.editUser(s,d).then(u=>u.data).then(u=>{n("/dashboard/users",{state:{message:{type:"success",text:`${c.name} editado com sucesso!`}}})}).catch(u=>{O.error(`Houve um erro ao editar ${c.name}.`),console.log(u)})}else F.createUser(c.email,c.name,c.password).then(d=>d.data).then(d=>{n("/dashboard/users",{state:{message:{type:"success",text:"Convite enviado com sucesso!"}}})}).catch(d=>{O.error("Houve um erro ao convidar usu\xE1rio."),console.log(d)})};return e.createElement(K,null,e.createElement("div",{className:"user-container title-container"},e.createElement(q,{"aria-label":"Voltar",component:"span",onClick:()=>{n("/dashboard/users")}},e.createElement(ae,null)),e.createElement("h2",null,s?"Editar Usu\xE1rio":"Cadastrar Usu\xE1rio")),e.createElement("div",{className:"user-container"},e.createElement("form",{onSubmit:E,action:"#"},e.createElement(P,{color:"secondary",variant:"outlined",fullWidth:!0,margin:"normal"},e.createElement($,{htmlFor:"text"},"Nome"),e.createElement(D,{id:"name",type:"text",value:c.name,onChange:f("name"),label:"Nome"})),e.createElement(P,{color:"secondary",variant:"outlined",fullWidth:!0,margin:"normal"},e.createElement($,{htmlFor:"text"},"E-mail"),e.createElement(D,{id:"email",type:"email",value:c.email,onChange:f("email"),label:"E-mail"})),e.createElement(P,{variant:"outlined",fullWidth:!0,margin:"normal"},e.createElement($,{hidden:!s||!!s&&s!==(a==null?void 0:a.id),color:"secondary",htmlFor:"text"},"Senha"),e.createElement(D,{id:"password",hidden:!s||!!s&&s!==(a==null?void 0:a.id),type:"text",value:c.password,onChange:f("password"),label:"Senha",color:"secondary"})),e.createElement(I,{type:"submit","data-testid":"submit-button",variant:"contained",color:"secondary",disableElevation:!0},s?"Enviar":"Convidar"))))}function St(){const t=U(),[a,n]=m.exports.useState([]),[s,o]=m.exports.useState(!1),[l,r]=m.exports.useState(),c=i=>{F.deleteUser(i).then(()=>{O.success("Usu\xE1rio exclu\xEDdo com sucesso!"),E()}).catch(d=>{O.error("Houve um erro ao excluir o usu\xE1rio")})},p=i=>{r(i),o(!0)},f=()=>{r(void 0),o(!1)},E=()=>{F.getUsers().then(i=>{n(i.data)})};return m.exports.useEffect(()=>{E()},[]),e.createElement(K,null,e.createElement("div",{className:"user-container title-container"},e.createElement("h2",null,"Usu\xE1rios Cadastrados"),e.createElement(I,{"data-testid":"add_user-button",variant:"outlined",color:"secondary",onClick:()=>{t("/dashboard/users/create",{state:{id:"",name:"",email:""}})}},"CRIAR NOVO")),e.createElement("div",{className:"user-container",style:{display:"none"}},e.createElement(We,{id:"search",label:"Pesquisar",InputProps:{startAdornment:e.createElement(ue,{position:"start"},e.createElement(Je,null))},variant:"standard"})),e.createElement("div",{className:"user-container"},e.createElement(_e,null,e.createElement(Ve,{sx:{minWidth:450},size:"small"},e.createElement(Ke,null,e.createElement(le,null,e.createElement(W,null,"Nome"),e.createElement(W,null,"Email"),e.createElement(W,{align:"center"},"A\xE7\xF5es"))),e.createElement(Xe,null,a.map(i=>e.createElement(le,{key:i.id,sx:{"&:last-child td, &:last-child th":{border:0}}},e.createElement(W,{width:"40%","data-testid":"user-name"},i.name),e.createElement(W,{width:"40%"},i.email),e.createElement(W,{width:"20%",align:"center"},e.createElement(q,{"aria-label":"Editar","data-testid":"edit_user-button",component:"span",onClick:()=>{t("/dashboard/users/edit",{state:{id:i.id,name:i.name,email:i.email,password:i.password}})}},e.createElement(fe,null)),e.createElement(q,{"data-testid":"delete_user-button","aria-label":"Deletar",component:"span",onClick:()=>p(i.id)},e.createElement(ve,null)),e.createElement(Z,{title:"Excluir usu\xE1rio",text:`Tem certeza que deseja excluir o usu\xE1rio ${i.name}?`,isOpen:s&&l==i.id,handleClose:()=>f(),handleConfirm:()=>c(i.id)})))))))))}function Tt(){const{user:t,storeToken:a,storeUser:n}=R(),s=m.exports.useMemo(()=>{let o=!!t;if(!t){const l=M();l&&(o=!0,n(l.user),a((l==null?void 0:l.token)||""))}return o},[t]);return e.createElement(Ge,null,e.createElement(Ye,null,s?e.createElement(e.Fragment,null,e.createElement(A,{path:"/dashboard",element:e.createElement(_,{to:"/dashboard/questions"})}),e.createElement(A,{path:"/dashboard/users",element:e.createElement(St,null)}),e.createElement(A,{path:"/dashboard/users/create",element:e.createElement(de,null)}),e.createElement(A,{path:"/dashboard/users/edit",element:e.createElement(de,null)}),e.createElement(A,{path:"/dashboard/questions",element:e.createElement(Nt,null)}),e.createElement(A,{path:"/dashboard/questions/create",element:e.createElement(xt,null)}),e.createElement(A,{path:"/dashboard/questions/edit",element:e.createElement(yt,null)}),e.createElement(A,{path:"questions",element:e.createElement(_,{to:"/dashboard/questions"})}),e.createElement(A,{path:"users",element:e.createElement(_,{to:"/dashboard/users"})}),e.createElement(A,{path:"dashboard",element:e.createElement(_,{to:"/dashboard/questions"})})):e.createElement(e.Fragment,null,e.createElement(A,{path:"login",element:e.createElement(it,null)}),e.createElement(A,{path:"request-password",element:e.createElement(dt,null)}),e.createElement(A,{path:"reset-password",element:e.createElement(mt,null)})),e.createElement(A,{path:"/",element:e.createElement(ft,null)}),e.createElement(A,{path:"*",element:e.createElement(_,{to:s?"/dashboard":"/",replace:!0})})))}function kt(){return e.createElement(e.Fragment,null,e.createElement(nt,null,e.createElement(Ze,{theme:we},e.createElement(et,null),e.createElement(Tt,null))))}tt.render(e.createElement(e.StrictMode,null,e.createElement(kt,null)),document.getElementById("root"));
